# 部署文档

本部署文档适用于本地开发环境、测试环境及生产环境的快速部署，涵盖后端（FastAPI）、前端（React+Vite）及数据库（SQLite）。

---

## 一、环境准备

### 1. 系统要求

- 推荐操作系统：Linux / macOS / Windows 10+
- Python 3.8 及以上
- Node.js 18 及以上
- Git（可选，便于代码管理）

### 2. 依赖工具

- pip（Python 包管理器）
- npm 或 yarn（Node 包管理器）

---

## 二、后端部署（FastAPI + SQLite）

### 1. 创建虚拟环境

```bash
cd backend
python3 -m venv .venv
source .venv/bin/activate  # Windows 用 .venv\Scripts\activate
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

如 requirements.txt 缺失，可手动安装：

```bash
pip install fastapi uvicorn pydantic httpx
```

### 3. 启动服务

```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

- 默认监听 8000 端口
- 首次启动会自动创建 todo.db 数据库
- 访问 http://127.0.0.1:8000/docs 查看接口文档

### 4. 生产部署建议

- 推荐使用 gunicorn + uvicorn worker 或 docker 部署
- 示例（gunicorn）：
  ```bash
  pip install gunicorn
  gunicorn main:app -k uvicorn.workers.UvicornWorker -b 0.0.0.0:8000
  ```
- 可配合 supervisor/systemd 实现守护进程

---

## 三、前端部署（React + Vite）

### 1. 安装依赖

```bash
cd front
npm install
```

### 2. 本地开发启动

```bash
npm run dev
```

- 默认访问 http://localhost:5173
- 已配置接口代理，无需手动更改

### 3. 生产环境打包

```bash
npm run build
```

- 生成静态文件在 `front/dist/`
- 可用 nginx、apache、vercel、netlify 等静态服务器部署

#### Nginx 示例配置：

```
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/front/dist;
    index index.html;
    location /todos/ {
        proxy_pass http://127.0.0.1:8000/todos/;
        proxy_set_header Host $host;
    }
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

---

## 四、数据库（SQLite）

- SQLite 为文件型数据库，自动生成于 backend 目录下，无需单独部署
- 生产环境建议定期备份 todo.db 文件

---

## 五、常见问题与排查

- 端口冲突：修改 uvicorn/nginx 配置
- 依赖安装失败：检查网络或更换 pip/npm 镜像源
- 前后端接口不通：检查代理、CORS、端口
- 数据库权限：确保 backend 目录有写权限

---

## 六、自动化与扩展建议

- 可用 docker-compose 一键部署前后端
- 推荐使用 CI/CD 工具（如 GitHub Actions）自动化测试与部署

---

如有特殊部署需求或遇到无法解决的问题，请联系开发者或运维支持。
